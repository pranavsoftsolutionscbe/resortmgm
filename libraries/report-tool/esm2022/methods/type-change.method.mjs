import { ToWords } from "to-words";
import { sort } from "./common.method";
export function pageCaptions(captions) {
    const returnVal = captions.reduce((init, item) => {
        init[item.ControlName] = item.ControlCaption;
        return init;
    }, {});
    return returnVal;
}
export function xmlToJson(xml) {
    const xml2json = (srcDOM) => {
        const children = [];
        Object.keys(srcDOM.children).forEach((key) => {
            children.push(srcDOM.children[key]);
        });
        // base case for recursion.
        if (!children.length) {
            return srcDOM.innerHTML;
        }
        // initializing object to be returned.
        const jsonResult = {};
        children.forEach((child) => {
            // checking is child has siblings of same name.
            const childIsArray = children.filter((eachChild) => eachChild.nodeName === child.nodeName)
                .length > 1;
            // if child is array, save the values as array, else as strings.
            if (childIsArray) {
                if (jsonResult[child.nodeName] === undefined) {
                    jsonResult[child.nodeName] = [xml2json(child)];
                }
                else {
                    jsonResult[child.nodeName].push(xml2json(child));
                }
            }
            else {
                jsonResult[child.nodeName] = xml2json(child);
            }
        });
        return jsonResult;
    };
    const parser = new DOMParser();
    return xml2json(parser.parseFromString(xml, "application/xml"));
}
export function hexToRgb(hex) {
    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result
        ? [
            parseInt(result[1], 16),
            parseInt(result[2], 16),
            parseInt(result[3], 16),
        ]
        : null;
}
export function rgbToHex(r, g, b) {
    function componentToHex(c) {
        const hex = c.toString(16);
        return hex.length === 1 ? "0" + hex : hex;
    }
    return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
}
export function loginNumberFormat(value, digits = -1, numberFormat = "") {
    value = value && value.toString().length ? value : "0";
    const [fDecimal, fFraction] = numberFormat.toString().split(".");
    const seperators = fDecimal.split(",").reverse();
    const [vDecimal, vFraction] = value.toString().split(".");
    const vDecimalRev = vDecimal.split("").reverse();
    const returnDecimal = seperators.reduce((init, current, idx) => {
        const start = init.replace(",", "").length;
        const end = start + current.length;
        const val = vDecimalRev.slice(start, end).reverse().join("");
        init = val + (val.length && init.length ? "," : "") + init;
        if (idx === seperators.length - 1) {
            const lastStart = init.replace(",", "").length;
            const lastEnd = vDecimalRev.length;
            const lastVal = vDecimalRev.slice(lastStart, lastEnd).reverse().join("");
            init = lastVal + (lastVal.length && init.length ? "," : "") + init;
        }
        return init;
    }, "");
    if (digits === -1) {
        digits = fFraction ? fFraction.length : 0;
    }
    const returnFraction = digits
        ? Number("." + (vFraction || 0))
            .toFixed(digits)
            .substr(1)
        : "";
    return returnDecimal + returnFraction;
}
export function changeMenuItem(array, keys, isSort = false) {
    let [labelKey, valueKey] = keys;
    valueKey = valueKey || labelKey;
    const returnValue = array.map((item) => ({
        label: item[labelKey],
        value: valueKey ? item[valueKey] : item,
        data: item,
    }));
    return isSort ? sort(returnValue, "label") : returnValue;
}
export function num2Word(num, locale) {
    const converterOptions = { currency: !!locale };
    const toWord = new ToWords({
        localeCode: locale || "en-US",
        converterOptions,
    });
    return toWord.convert(num);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZS1jaGFuZ2UubWV0aG9kLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvcmVwb3J0LXRvb2wvbWV0aG9kcy90eXBlLWNoYW5nZS5tZXRob2QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUtuQyxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFdkMsTUFBTSxVQUFVLFlBQVksQ0FBQyxRQUFlO0lBQzFDLE1BQU0sU0FBUyxHQUFRLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUU7UUFDcEQsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDO1FBQzdDLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ1AsT0FBTyxTQUFTLENBQUM7QUFDbkIsQ0FBQztBQUVELE1BQU0sVUFBVSxTQUFTLENBQUMsR0FBVztJQUNuQyxNQUFNLFFBQVEsR0FBRyxDQUFDLE1BQVcsRUFBTyxFQUFFO1FBQ3BDLE1BQU0sUUFBUSxHQUFVLEVBQUUsQ0FBQztRQUMzQixNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRTtZQUMzQyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUN0QyxDQUFDLENBQUMsQ0FBQztRQUVILDJCQUEyQjtRQUMzQixJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRTtZQUNwQixPQUFPLE1BQU0sQ0FBQyxTQUFTLENBQUM7U0FDekI7UUFFRCxzQ0FBc0M7UUFDdEMsTUFBTSxVQUFVLEdBQVEsRUFBRSxDQUFDO1FBRTNCLFFBQVEsQ0FB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QyxNQUFNLGdCQUFnQixHQUFxQixFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDbEUsTUFBTSxNQUFNLEdBQUcsSUFBSSxPQUFPLENBQUM7UUFDekIsVUFBVSxFQUFFLE1BQU0sSUFBSSxPQUFPO1FBQzdCLGdCQUFnQjtLQUNqQixDQUFDLENBQUM7SUFDSCxPQUFPLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDN0IsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRvV29yZHMgfSBmcm9tIFwidG8td29yZHNcIjtcclxuaW1wb3J0IHsgQ29udmVydGVyT3B0aW9ucyB9IGZyb20gXCJ0by13b3Jkcy9kaXN0L3R5cGVzXCI7XHJcblxyXG5pbXBvcnQgeyBJTWVudUl0ZW0gfSBmcm9tIFwicmVwb3J0LXRvb2wvbW9kZWxzXCI7XHJcblxyXG5pbXBvcnQgeyBzb3J0IH0gZnJvbSBcIi4vY29tbW9uLm1ldGhvZFwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHBhZ2VDYXB0aW9ucyhjYXB0aW9uczogYW55W10pOiBhbnkge1xyXG4gIGNvbnN0IHJldHVyblZhbDogYW55ID0gY2FwdGlvbnMucmVkdWNlKChpbml0LCBpdGVtKSA9PiB7XHJcbiAgICBpbml0W2l0ZW0uQ29udHJvbE5hbWVdID0gaXRlbS5Db250cm9sQ2FwdGlvbjtcclxuICAgIHJldHVybiBpbml0O1xyXG4gIH0sIHt9KTtcclxuICByZXR1cm4gcmV0dXJuVmFsO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24geG1sVG9Kc29uKHhtbDogc3RyaW5nKTogYW55IHtcclxuICBjb25zdCB4bWwyanNvbiA9IChzcmNET006IGFueSk6IGFueSA9PiB7XHJcbiAgICBjb25zdCBjaGlsZHJlbjogYW55W10gPSBbXTtcclxuICAgIE9iamVjdC5rZXlzKHNyY0RPTS5jaGlsZHJlbikuZm9yRWFjaCgoa2V5KSA9PiB7XHJcbiAgICAgIGNoaWxkcmVuLnB1c2goc3JjRE9NLmNoaWxkcmVuW2tleV0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gYmFzZSBjYXNlIGZvciByZWN1cnNpb24uXHJcbiAgICBpZiAoIWNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICByZXR1cm4gc3JjRE9NLmlubmVySFRNTDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBpbml0aWFsaXppbmcgb2JqZWN0IHRvIGJlIHJldHVybmVkLlxyXG4gICAgY29uc3QganNvblJlc3VsdDogYW55ID0ge307XHJcblxyXG4gICAgY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcclxuICAgICAgLy8gY2hlY2tpbmcgaXMgY2hpbGQgaGFzIHNpYmxpbmdzIG9mIHNhbWUgbmFtZS5cclxuICAgICAgY29uc3QgY2hpbGRJc0FycmF5ID1cclxuICAgICAgICBjaGlsZHJlbi5maWx0ZXIoKGVhY2hDaGlsZCkgPT4gZWFjaENoaWxkLm5vZGVOYW1lID09PSBjaGlsZC5ub2RlTmFtZSlcclxuICAgICAgICAgIC5sZW5ndGggPiAxO1xyXG5cclxuICAgICAgLy8gaWYgY2hpbGQgaXMgYXJyYXksIHNhdmUgdGhlIHZhbHVlcyBhcyBhcnJheSwgZWxzZSBhcyBzdHJpbmdzLlxyXG4gICAgICBpZiAoY2hpbGRJc0FycmF5KSB7XHJcbiAgICAgICAgaWYgKGpzb25SZXN1bHRbY2hpbGQubm9kZU5hbWVdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIGpzb25SZXN1bHRbY2hpbGQubm9kZU5hbWVdID0gW3htbDJqc29uKGNoaWxkKV07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGpzb25SZXN1bHRbY2hpbGQubm9kZU5hbWVdLnB1c2goeG1sMmpzb24oY2hpbGQpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAganNvblJlc3VsdFtjaGlsZC5ub2RlTmFtZV0gPSB4bWwyanNvbihjaGlsZCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBqc29uUmVzdWx0O1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcclxuICByZXR1cm4geG1sMmpzb24ocGFyc2VyLnBhcnNlRnJvbVN0cmluZyh4bWwsIFwiYXBwbGljYXRpb24veG1sXCIpKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhleFRvUmdiKGhleDogc3RyaW5nKTogYW55IHtcclxuICBjb25zdCByZXN1bHQgPSAvXiM/KFthLWZcXGRdezJ9KShbYS1mXFxkXXsyfSkoW2EtZlxcZF17Mn0pJC9pLmV4ZWMoaGV4KTtcclxuICByZXR1cm4gcmVzdWx0XHJcbiAgICA/IFtcclxuICAgICAgICBwYXJzZUludChyZXN1bHRbMV0sIDE2KSxcclxuICAgICAgICBwYXJzZUludChyZXN1bHRbMl0sIDE2KSxcclxuICAgICAgICBwYXJzZUludChyZXN1bHRbM10sIDE2KSxcclxuICAgICAgXVxyXG4gICAgOiBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmdiVG9IZXgocjogbnVtYmVyLCBnOiBudW1iZXIsIGI6IG51bWJlcik6IHN0cmluZyB7XHJcbiAgZnVuY3Rpb24gY29tcG9uZW50VG9IZXgoYzogbnVtYmVyKSB7XHJcbiAgICBjb25zdCBoZXggPSBjLnRvU3RyaW5nKDE2KTtcclxuICAgIHJldHVybiBoZXgubGVuZ3RoID09PSAxID8gXCIwXCIgKyBoZXggOiBoZXg7XHJcbiAgfVxyXG4gIHJldHVybiBcIiNcIiArIGNvbXBvbmVudFRvSGV4KHIpICsgY29tcG9uZW50VG9IZXgoZykgKyBjb21wb25lbnRUb0hleChiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxvZ2luTnVtYmVyRm9ybWF0KFxyXG4gIHZhbHVlOiBudW1iZXIgfCBzdHJpbmcsXHJcbiAgZGlnaXRzID0gLTEsXHJcbiAgbnVtYmVyRm9ybWF0ID0gXCJcIlxyXG4pOiBzdHJpbmcge1xyXG4gIHZhbHVlID0gdmFsdWUgJiYgdmFsdWUudG9TdHJpbmcoKS5sZW5ndGggPyB2YWx1ZSA6IFwiMFwiO1xyXG4gIGNvbnN0IFtmRGVjaW1hbCwgZkZyYWN0aW9uXSA9IG51bWJlckZvcm1hdC50b1N0cmluZygpLnNwbGl0KFwiLlwiKTtcclxuICBjb25zdCBzZXBlcmF0b3JzID0gZkRlY2ltYWwuc3BsaXQoXCIsXCIpLnJldmVyc2UoKTtcclxuICBjb25zdCBbdkRlY2ltYWwsIHZGcmFjdGlvbl0gPSB2YWx1ZS50b1N0cmluZygpLnNwbGl0KFwiLlwiKTtcclxuICBjb25zdCB2RGVjaW1hbFJldiA9IHZEZWNpbWFsLnNwbGl0KFwiXCIpLnJldmVyc2UoKTtcclxuICBjb25zdCByZXR1cm5EZWNpbWFsID0gc2VwZXJhdG9ycy5yZWR1Y2UoKGluaXQsIGN1cnJlbnQsIGlkeCkgPT4ge1xyXG4gICAgY29uc3Qgc3RhcnQgPSBpbml0LnJlcGxhY2UoXCIsXCIsIFwiXCIpLmxlbmd0aDtcclxuICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgY3VycmVudC5sZW5ndGg7XHJcbiAgICBjb25zdCB2YWwgPSB2RGVjaW1hbFJldi5zbGljZShzdGFydCwgZW5kKS5yZXZlcnNlKCkuam9pbihcIlwiKTtcclxuICAgIGluaXQgPSB2YWwgKyAodmFsLmxlbmd0aCAmJiBpbml0Lmxlbmd0aCA/IFwiLFwiIDogXCJcIikgKyBpbml0O1xyXG4gICAgaWYgKGlkeCA9PT0gc2VwZXJhdG9ycy5sZW5ndGggLSAxKSB7XHJcbiAgICAgIGNvbnN0IGxhc3RTdGFydCA9IGluaXQucmVwbGFjZShcIixcIiwgXCJcIikubGVuZ3RoO1xyXG4gICAgICBjb25zdCBsYXN0RW5kID0gdkRlY2ltYWxSZXYubGVuZ3RoO1xyXG4gICAgICBjb25zdCBsYXN0VmFsID0gdkRlY2ltYWxSZXYuc2xpY2UobGFzdFN0YXJ0LCBsYXN0RW5kKS5yZXZlcnNlKCkuam9pbihcIlwiKTtcclxuICAgICAgaW5pdCA9IGxhc3RWYWwgKyAobGFzdFZhbC5sZW5ndGggJiYgaW5pdC5sZW5ndGggPyBcIixcIiA6IFwiXCIpICsgaW5pdDtcclxuICAgIH1cclxuICAgIHJldHVybiBpbml0O1xyXG4gIH0sIFwiXCIpO1xyXG4gIGlmIChkaWdpdHMgPT09IC0xKSB7XHJcbiAgICBkaWdpdHMgPSBmRnJhY3Rpb24gPyBmRnJhY3Rpb24ubGVuZ3RoIDogMDtcclxuICB9XHJcbiAgY29uc3QgcmV0dXJuRnJhY3Rpb24gPSBkaWdpdHNcclxuICAgID8gTnVtYmVyKFwiLlwiICsgKHZGcmFjdGlvbiB8fCAwKSlcclxuICAgICAgICAudG9GaXhlZChkaWdpdHMpXHJcbiAgICAgICAgLnN1YnN0cigxKVxyXG4gICAgOiBcIlwiO1xyXG4gIHJldHVybiByZXR1cm5EZWNpbWFsICsgcmV0dXJuRnJhY3Rpb247XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGFuZ2VNZW51SXRlbTxUPihcclxuICBhcnJheTogVFtdLFxyXG4gIGtleXM6IHN0cmluZ1tdLFxyXG4gIGlzU29ydCA9IGZhbHNlXHJcbik6IElNZW51SXRlbTxUPltdIHtcclxuICBsZXQgW2xhYmVsS2V5LCB2YWx1ZUtleV0gPSBrZXlzO1xyXG4gIHZhbHVlS2V5ID0gdmFsdWVLZXkgfHwgbGFiZWxLZXk7XHJcbiAgY29uc3QgcmV0dXJuVmFsdWUgPSBhcnJheS5tYXAoKGl0ZW0pID0+ICh7XHJcbiAgICBsYWJlbDogaXRlbVtsYWJlbEtleV0sXHJcbiAgICB2YWx1ZTogdmFsdWVLZXkgPyBpdGVtW3ZhbHVlS2V5XSA6IGl0ZW0sXHJcbiAgICBkYXRhOiBpdGVtLFxyXG4gIH0pKTtcclxuICByZXR1cm4gaXNTb3J0ID8gc29ydChyZXR1cm5WYWx1ZSwgXCJsYWJlbFwiKSA6IHJldHVyblZhbHVlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbnVtMldvcmQobnVtOiBudW1iZXIsIGxvY2FsZTogYW55KTogc3RyaW5nIHtcclxuICBjb25zdCBjb252ZXJ0ZXJPcHRpb25zOiBDb252ZXJ0ZXJPcHRpb25zID0geyBjdXJyZW5jeTogISFsb2NhbGUgfTtcclxuICBjb25zdCB0b1dvcmQgPSBuZXcgVG9Xb3Jkcyh7XHJcbiAgICBsb2NhbGVDb2RlOiBsb2NhbGUgfHwgXCJlbi1VU1wiLFxyXG4gICAgY29udmVydGVyT3B0aW9ucyxcclxuICB9KTtcclxuICByZXR1cm4gdG9Xb3JkLmNvbnZlcnQobnVtKTtcclxufVxyXG4iXX0=